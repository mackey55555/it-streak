import { createClient } from '@supabase/supabase-js';
import { Database } from '../types/database';

// ç’°å¢ƒå¤‰æ•°ã‹ã‚‰å–å¾—ï¼ˆå®Ÿè¡Œæ™‚ã«è¨­å®šã™ã‚‹ï¼‰
const supabaseUrl = process.env.EXPO_PUBLIC_SUPABASE_URL;
const supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY; // Service Roleã‚­ãƒ¼ã‚’ä½¿ç”¨

if (!supabaseUrl || !supabaseServiceKey) {
  console.error('ç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“');
  process.exit(1);
}

const supabase = createClient<Database>(supabaseUrl, supabaseServiceKey);

// ã‚«ãƒ†ã‚´ãƒªIDï¼ˆschema.sqlã§å®šç¾©ã—ãŸå›ºå®šIDï¼‰
const CATEGORY_IDS = {
  technology: '00000000-0000-0000-0000-000000000011',
  management: '00000000-0000-0000-0000-000000000012',
  strategy: '00000000-0000-0000-0000-000000000013',
};

// ã‚µãƒ³ãƒ—ãƒ«å•é¡Œãƒ‡ãƒ¼ã‚¿
const questions = [
  // ãƒ†ã‚¯ãƒãƒ­ã‚¸ç³»ï¼ˆ5å•ï¼‰
  {
    category_id: CATEGORY_IDS.technology,
    question_text: 'OSIåŸºæœ¬å‚ç…§ãƒ¢ãƒ‡ãƒ«ã«ãŠã„ã¦ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ã®å½¹å‰²ã¯ã©ã‚Œã‹ã€‚',
    choice_a: 'ä¼é€è·¯ä¸Šã®ãƒ“ãƒƒãƒˆåˆ—ã®ä¼é€',
    choice_b: 'éš£æ¥ãƒãƒ¼ãƒ‰é–“ã®ãƒ‡ãƒ¼ã‚¿è»¢é€',
    choice_c: 'ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã®ãƒ‡ãƒ¼ã‚¿è»¢é€ã®ä¿¡é ¼æ€§ç¢ºä¿',
    choice_d: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ä¸Šã®çµŒè·¯é¸æŠ',
    correct_answer: 'D' as const,
    explanation: 'ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ï¼ˆç¬¬3å±¤ï¼‰ã¯ã€ç•°ãªã‚‹ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–“ã®çµŒè·¯é¸æŠï¼ˆãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼‰ã‚’è¡Œã†å±¤ã§ã™ã€‚',
    difficulty: 2,
  },
  {
    category_id: CATEGORY_IDS.technology,
    question_text: '2é€²æ•°ã®10101ã‚’10é€²æ•°ã«å¤‰æ›ã—ãŸå€¤ã¯ã©ã‚Œã‹ã€‚',
    choice_a: '19',
    choice_b: '21',
    choice_c: '23',
    choice_d: '25',
    correct_answer: 'B' as const,
    explanation: '10101(2) = 1Ã—2^4 + 0Ã—2^3 + 1Ã—2^2 + 0Ã—2^1 + 1Ã—2^0 = 16 + 4 + 1 = 21',
    difficulty: 1,
  },
  {
    category_id: CATEGORY_IDS.technology,
    question_text: 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ACIDç‰¹æ€§ã®ã†ã¡ã€ã€ŒåŸå­æ€§ï¼ˆAtomicityï¼‰ã€ã®èª¬æ˜ã¨ã—ã¦é©åˆ‡ãªã‚‚ã®ã¯ã©ã‚Œã‹ã€‚',
    choice_a: 'ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®å‰å¾Œã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ•´åˆæ€§ãŒä¿ãŸã‚Œã‚‹ã“ã¨',
    choice_b: 'ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãŒå…¨ã¦å®Ÿè¡Œã•ã‚Œã‚‹ã‹ã€å…¨ãå®Ÿè¡Œã•ã‚Œãªã„ã‹ã®ã©ã¡ã‚‰ã‹ã§ã‚ã‚‹ã“ã¨',
    choice_c: 'è¤‡æ•°ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãŒåŒæ™‚ã«å®Ÿè¡Œã•ã‚Œã¦ã‚‚ã€çµæœãŒé€æ¬¡å®Ÿè¡Œã¨åŒã˜ã«ãªã‚‹ã“ã¨',
    choice_d: 'ã‚³ãƒŸãƒƒãƒˆã•ã‚ŒãŸãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®çµæœãŒæ°¸ç¶šçš„ã«ä¿å­˜ã•ã‚Œã‚‹ã“ã¨',
    correct_answer: 'B' as const,
    explanation: 'åŸå­æ€§ã¨ã¯ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãŒã€Œå…¨ã¦æˆåŠŸã€ã‹ã€Œå…¨ã¦å¤±æ•—ã€ã®ã„ãšã‚Œã‹ã§ã‚ã‚Šã€ä¸­é–“çŠ¶æ…‹ãŒå­˜åœ¨ã—ãªã„ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚',
    difficulty: 2,
  },
  {
    category_id: CATEGORY_IDS.technology,
    question_text: 'TCPã¨UDPã®é•ã„ã«é–¢ã™ã‚‹èª¬æ˜ã¨ã—ã¦ã€é©åˆ‡ãªã‚‚ã®ã¯ã©ã‚Œã‹ã€‚',
    choice_a: 'TCPã¯ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ã‚¹å‹ã€UDPã¯ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³å‹ã§ã‚ã‚‹',
    choice_b: 'TCPã¯ä¿¡é ¼æ€§ãŒã‚ã‚Šã€UDPã¯ä¿¡é ¼æ€§ãŒãªã„',
    choice_c: 'TCPã¯ãƒ‡ãƒ¼ã‚¿ã‚°ãƒ©ãƒ å‹ã€UDPã¯ã‚¹ãƒˆãƒªãƒ¼ãƒ å‹ã§ã‚ã‚‹',
    choice_d: 'TCPã¯é€Ÿåº¦ãŒé€Ÿãã€UDPã¯é€Ÿåº¦ãŒé…ã„',
    correct_answer: 'B' as const,
    explanation: 'TCPã¯æ¥ç¶šç¢ºç«‹ãƒ»ãƒ‡ãƒ¼ã‚¿åˆ°é”ç¢ºèªãƒ»å†é€åˆ¶å¾¡ã‚’è¡Œã†ä¿¡é ¼æ€§ã®ã‚ã‚‹ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã€UDPã¯ã“ã‚Œã‚‰ã‚’è¡Œã‚ãªã„é«˜é€Ÿã ãŒä¿¡é ¼æ€§ã®ãªã„ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã§ã™ã€‚',
    difficulty: 2,
  },
  {
    category_id: CATEGORY_IDS.technology,
    question_text: 'ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã«ãŠã‘ã‚‹ã€Œã‚«ãƒ—ã‚»ãƒ«åŒ–ã€ã®èª¬æ˜ã¨ã—ã¦é©åˆ‡ãªã‚‚ã®ã¯ã©ã‚Œã‹ã€‚',
    choice_a: 'ãƒ‡ãƒ¼ã‚¿ã¨å‡¦ç†ã‚’ä¸€ã¤ã«ã¾ã¨ã‚ã€å¤–éƒ¨ã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’åˆ¶é™ã™ã‚‹ã“ã¨',
    choice_b: 'æ—¢å­˜ã®ã‚¯ãƒ©ã‚¹ã‚’åŸºã«æ–°ã—ã„ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã™ã‚‹ã“ã¨',
    choice_c: 'åŒã˜åå‰ã®ãƒ¡ã‚½ãƒƒãƒ‰ã§ç•°ãªã‚‹å‡¦ç†ã‚’å®Ÿç¾ã™ã‚‹ã“ã¨',
    choice_d: 'ç•°ãªã‚‹ã‚¯ãƒ©ã‚¹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’åŒã˜ã‚ˆã†ã«æ‰±ã†ã“ã¨',
    correct_answer: 'A' as const,
    explanation: 'ã‚«ãƒ—ã‚»ãƒ«åŒ–ã¯ã€ãƒ‡ãƒ¼ã‚¿ï¼ˆå±æ€§ï¼‰ã¨ãã‚Œã‚’æ“ä½œã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä¸€ã¤ã«ã¾ã¨ã‚ã€æƒ…å ±éš è”½ã«ã‚ˆã£ã¦å¤–éƒ¨ã‹ã‚‰ã®ä¸æ­£ãªã‚¢ã‚¯ã‚»ã‚¹ã‚’é˜²ãæ¦‚å¿µã§ã™ã€‚',
    difficulty: 2,
  },
  
  // ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆç³»ï¼ˆ3å•ï¼‰
  {
    category_id: CATEGORY_IDS.management,
    question_text: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã«ãŠã‘ã‚‹WBSï¼ˆWork Breakdown Structureï¼‰ã®èª¬æ˜ã¨ã—ã¦é©åˆ‡ãªã‚‚ã®ã¯ã©ã‚Œã‹ã€‚',
    choice_a: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæ¥­ã‚’éšå±¤çš„ã«åˆ†è§£ã—ãŸã‚‚ã®',
    choice_b: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é€²æ—ã‚’ç®¡ç†ã™ã‚‹ã‚¬ãƒ³ãƒˆãƒãƒ£ãƒ¼ãƒˆ',
    choice_c: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒªã‚¹ã‚¯ã‚’ä¸€è¦§åŒ–ã—ãŸã‚‚ã®',
    choice_d: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æˆæœç‰©ã‚’å®šç¾©ã—ãŸæ–‡æ›¸',
    correct_answer: 'A' as const,
    explanation: 'WBSã¯ä½œæ¥­åˆ†è§£å›³ã¨ã‚‚å‘¼ã°ã‚Œã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæ¥­ã‚’ç®¡ç†å¯èƒ½ãªå°ã•ãªå˜ä½ã«éšå±¤çš„ã«åˆ†è§£ã—ãŸã‚‚ã®ã§ã™ã€‚',
    difficulty: 2,
  },
  {
    category_id: CATEGORY_IDS.management,
    question_text: 'ITILï¼ˆInformation Technology Infrastructure Libraryï¼‰ã«ãŠã‘ã‚‹ã€Œã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç†ã€ã®ç›®çš„ã¨ã—ã¦é©åˆ‡ãªã‚‚ã®ã¯ã©ã‚Œã‹ã€‚',
    choice_a: 'ã‚·ã‚¹ãƒ†ãƒ ã®æ ¹æœ¬åŸå› ã‚’ç‰¹å®šã—ã€å†ç™ºã‚’é˜²æ­¢ã™ã‚‹ã“ã¨',
    choice_b: 'ITã‚µãƒ¼ãƒ“ã‚¹ã®æ­£å¸¸ãªé‹ç”¨ã‚’å¯èƒ½ãªé™ã‚Šè¿…é€Ÿã«å›å¾©ã™ã‚‹ã“ã¨',
    choice_c: 'ã‚·ã‚¹ãƒ†ãƒ ã®å¤‰æ›´ã‚’è¨ˆç”»çš„ã«å®Ÿæ–½ã™ã‚‹ã“ã¨',
    choice_d: 'ITã‚µãƒ¼ãƒ“ã‚¹ã®å¯ç”¨æ€§ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨',
    correct_answer: 'B' as const,
    explanation: 'ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç†ã®ç›®çš„ã¯ã€ã‚µãƒ¼ãƒ“ã‚¹ã®ä¸­æ–­ã‚’æœ€å°é™ã«æŠ‘ãˆã€ã§ãã‚‹ã ã‘è¿…é€Ÿã«ã‚µãƒ¼ãƒ“ã‚¹ã‚’å¾©æ—§ã•ã›ã‚‹ã“ã¨ã§ã™ã€‚æ ¹æœ¬åŸå› ã®ç‰¹å®šã¯å•é¡Œç®¡ç†ã®å½¹å‰²ã§ã™ã€‚',
    difficulty: 3,
  },
  {
    category_id: CATEGORY_IDS.management,
    question_text: 'ã‚¢ã‚¸ãƒ£ã‚¤ãƒ«é–‹ç™ºã«ãŠã‘ã‚‹ã€Œã‚¹ãƒ—ãƒªãƒ³ãƒˆã€ã®èª¬æ˜ã¨ã—ã¦é©åˆ‡ãªã‚‚ã®ã¯ã©ã‚Œã‹ã€‚',
    choice_a: 'é–‹ç™ºã®æœ€çµ‚æ®µéšã§è¡Œã†ç·åˆãƒ†ã‚¹ãƒˆæœŸé–“',
    choice_b: 'å›ºå®šã•ã‚ŒãŸçŸ­ã„æœŸé–“ã§é–‹ç™ºã‚’ç¹°ã‚Šè¿”ã™å˜ä½',
    choice_c: 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸæ®µéšã§è¡Œã†è¦ä»¶å®šç¾©æœŸé–“',
    choice_d: 'ã‚·ã‚¹ãƒ†ãƒ ã®ãƒªãƒªãƒ¼ã‚¹å¾Œã«è¡Œã†ä¿å®ˆæœŸé–“',
    correct_answer: 'B' as const,
    explanation: 'ã‚¹ãƒ—ãƒªãƒ³ãƒˆã¯ã€1ã€œ4é€±é–“ç¨‹åº¦ã®å›ºå®šæœŸé–“ã§è¨­å®šã•ã‚Œã€è¨ˆç”»â†’é–‹ç™ºâ†’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ã‚µã‚¤ã‚¯ãƒ«ã‚’ç¹°ã‚Šè¿”ã™é–‹ç™ºã®å˜ä½ã§ã™ã€‚',
    difficulty: 2,
  },
  
  // ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ç³»ï¼ˆ2å•ï¼‰
  {
    category_id: CATEGORY_IDS.strategy,
    question_text: 'SWOTåˆ†æã«ãŠã‘ã‚‹ã€Œæ©Ÿä¼šï¼ˆOpportunityï¼‰ã€ã«è©²å½“ã™ã‚‹ã‚‚ã®ã¯ã©ã‚Œã‹ã€‚',
    choice_a: 'è‡ªç¤¾ã®å¼·ã¿',
    choice_b: 'è‡ªç¤¾ã®å¼±ã¿',
    choice_c: 'å¤–éƒ¨ç’°å¢ƒã®ãƒ—ãƒ©ã‚¹è¦å› ',
    choice_d: 'å¤–éƒ¨ç’°å¢ƒã®ãƒã‚¤ãƒŠã‚¹è¦å› ',
    correct_answer: 'C' as const,
    explanation: 'SWOTåˆ†æã§ã¯ã€å†…éƒ¨ç’°å¢ƒã®å¼·ã¿ï¼ˆStrengthï¼‰ãƒ»å¼±ã¿ï¼ˆWeaknessï¼‰ã¨ã€å¤–éƒ¨ç’°å¢ƒã®æ©Ÿä¼šï¼ˆOpportunityï¼‰ãƒ»è„…å¨ï¼ˆThreatï¼‰ã‚’åˆ†æã—ã¾ã™ã€‚',
    difficulty: 1,
  },
  {
    category_id: CATEGORY_IDS.strategy,
    question_text: 'å€‹äººæƒ…å ±ä¿è­·æ³•ã«ãŠã‘ã‚‹ã€Œå€‹äººæƒ…å ±ã€ã®å®šç¾©ã«è©²å½“ã—ãªã„ã‚‚ã®ã¯ã©ã‚Œã‹ã€‚',
    choice_a: 'æ°å',
    choice_b: 'ç”Ÿå¹´æœˆæ—¥',
    choice_c: 'çµ±è¨ˆå‡¦ç†ã•ã‚ŒãŸåŒ¿åãƒ‡ãƒ¼ã‚¿',
    choice_d: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹',
    correct_answer: 'C' as const,
    explanation: 'å€‹äººæƒ…å ±ã¯ã€Œç”Ÿå­˜ã™ã‚‹å€‹äººã«é–¢ã™ã‚‹æƒ…å ±ã§ã€ç‰¹å®šã®å€‹äººã‚’è­˜åˆ¥ã§ãã‚‹ã‚‚ã®ã€ã§ã™ã€‚çµ±è¨ˆåŒ–ãƒ»åŒ¿ååŒ–ã•ã‚Œå€‹äººã‚’è­˜åˆ¥ã§ããªã„ãƒ‡ãƒ¼ã‚¿ã¯è©²å½“ã—ã¾ã›ã‚“ã€‚',
    difficulty: 2,
  },
];

async function seedQuestions() {
  console.log('ğŸŒ± å•é¡Œãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥ã‚’é–‹å§‹ã—ã¾ã™...\n');

  try {
    // æ—¢å­˜ã®å•é¡Œã‚’å‰Šé™¤ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
    console.log('æ—¢å­˜ã®å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’ç¢ºèªä¸­...');
    const { count } = await supabase
      .from('questions')
      .select('*', { count: 'exact', head: true });

    if (count && count > 0) {
      console.log(`æ—¢å­˜ã®å•é¡ŒãŒ${count}ä»¶è¦‹ã¤ã‹ã‚Šã¾ã—ãŸã€‚`);
      console.log('å‰Šé™¤ã™ã‚‹å ´åˆã¯ã€Supabase SQLã‚¨ãƒ‡ã‚£ã‚¿ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„:');
      console.log('DELETE FROM questions;\n');
    }

    // å•é¡Œã‚’æŠ•å…¥
    console.log(`${questions.length}ä»¶ã®å•é¡Œã‚’æŠ•å…¥ä¸­...\n`);

    const { data, error } = await supabase
      .from('questions')
      .insert(questions)
      .select();

    if (error) {
      throw error;
    }

    console.log('âœ… å•é¡Œãƒ‡ãƒ¼ã‚¿ã®æŠ•å…¥ãŒå®Œäº†ã—ã¾ã—ãŸï¼');
    console.log(`æŠ•å…¥ã•ã‚ŒãŸå•é¡Œæ•°: ${data.length}ä»¶\n`);

    // ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®ä»¶æ•°ã‚’è¡¨ç¤º
    const techCount = data.filter(q => q.category_id === CATEGORY_IDS.technology).length;
    const mgmtCount = data.filter(q => q.category_id === CATEGORY_IDS.management).length;
    const stratCount = data.filter(q => q.category_id === CATEGORY_IDS.strategy).length;

    console.log('ğŸ“Š ã‚«ãƒ†ã‚´ãƒªåˆ¥ã®ä»¶æ•°:');
    console.log(`  - ãƒ†ã‚¯ãƒãƒ­ã‚¸ç³»: ${techCount}ä»¶`);
    console.log(`  - ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆç³»: ${mgmtCount}ä»¶`);
    console.log(`  - ã‚¹ãƒˆãƒ©ãƒ†ã‚¸ç³»: ${stratCount}ä»¶`);

  } catch (error) {
    console.error('âŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ:', error);
    process.exit(1);
  }
}

// å®Ÿè¡Œ
seedQuestions();

